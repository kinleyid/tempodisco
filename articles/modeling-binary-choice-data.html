<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling binary choice data • tempodisco</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling binary choice data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tempodisco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adjusting-amounts.html">Working with data from an adjusting amount procedure</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing-study.html">Analyzing data from multiple participants</a></li>
    <li><a class="dropdown-item" href="../articles/comparing-models.html">Comparing discounting across different discount functions</a></li>
    <li><a class="dropdown-item" href="../articles/custom-discount-functions.html">Creating custom discount functions</a></li>
    <li><a class="dropdown-item" href="../articles/drift-diffusion-models.html">Drift diffusion models</a></li>
    <li><a class="dropdown-item" href="../articles/model-free-auc.html">Computing model-free area under the curve (AUC)</a></li>
    <li><a class="dropdown-item" href="../articles/modeling-binary-choice-data.html">Modeling binary choice data</a></li>
    <li><a class="dropdown-item" href="../articles/nonsystematic-discounting.html">Indentifying non-systematic discounting</a></li>
    <li><a class="dropdown-item" href="../articles/visualizing-models.html">Visualizing models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Modeling binary choice data</h1>
            
      

      <div class="d-none name"><code>modeling-binary-choice-data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kinleyid.github.io/tempodisco/">tempodisco</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="classic-methods">Classic methods<a class="anchor" aria-label="anchor" href="#classic-methods"></a>
</h2>
<p>For binary choice data not explicitly designed to titrate out
indifference points (as in an adjusting amount procedure), there are a
few analysis options. A common one is the scoring method designed for
the Monetary Choice Questionnaire <a href="https://doi.org/10.1037//0096-3445.128.1.78" class="external-link">(Kirby,
1999)</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"td_bc_single_ptpt"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kirby_score.html">kirby_score</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting indifference point model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: hyperbolic, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.02176563 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ED50: 45.9439876371218</span></span>
<span><span class="co">#&gt; AUC: 0.0551987542147013</span></span></code></pre></div>
<p>Although this method computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
values according to the hyperbolic discount function, in principle it’s
possible to use the exponential discount function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kirby_score.html">kirby_score</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting indifference point model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: exponential, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           k </span></span>
<span><span class="co">#&gt; 0.008170247 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ED50: 84.8379742026149</span></span>
<span><span class="co">#&gt; AUC: 0.0335100135964859</span></span></code></pre></div>
<p>Another option is to use the logistic regression method of <a href="https://doi.org/10.3758/BF03195548" class="external-link">Wileyto et al. (2004)</a>,
where we can solve for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
value of the hyperbolic discount function in terms of the regression
coefficients:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wileyto_score.html">wileyto_score</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting binary choice linear model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: hyperbolic from model hyperbolic.1, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.04372626 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = fml, family = binomial(link = "logit"), data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     .B1      .B2  </span></span>
<span><span class="co">#&gt; 0.49900  0.02182  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 70 Total (i.e. Null);  68 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       97.04 </span></span>
<span><span class="co">#&gt; Residual Deviance: 37.47     AIC: 41.47</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="newer-methods">Newer methods<a class="anchor" aria-label="anchor" href="#newer-methods"></a>
</h2>
<p>The <a href="https://doi.org/10.3758/BF03195548" class="external-link">Wileyto et
al. (2004)</a> approach turns out to be possible for other discount
functions as well:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Discount function</th>
<th>Linear predictor</th>
<th>Parameters</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>hyperbolic.1</code></td>
<td>Hyperbolic (<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur,
1987</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1 + kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>v</mi><mi>D</mi></msub><msub><mi>v</mi><mi>I</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>t</mi></mrow><annotation encoding="application/x-tex">\beta_1 \left(1 - \frac{v_D}{v_I} \right) + \beta_2 t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">k = \frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><code>hyperbolic.2</code></td>
<td>(<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur,
1987</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1 + kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>ℐ</mi></msub><msub><mi>v</mi><mi>𝒟</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mo>log</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1\left( \sigma^{-1}\left[\frac{v_\mathcal{I}}{v_\mathcal{D}}\right] + \log t \right) + \beta_2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><code>exponential.1</code></td>
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson,
1937</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup><annotation encoding="application/x-tex">e^{-kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>log</mo><mfrac><msub><mi>v</mi><mi>I</mi></msub><msub><mi>v</mi><mi>D</mi></msub></mfrac><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>t</mi></mrow><annotation encoding="application/x-tex">\beta_1 \log \frac{v_I}{v_D} + \beta_2 t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">k = \frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><code>exponential.2</code></td>
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson,
1937</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup><annotation encoding="application/x-tex">e^{-kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>G</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>ℐ</mi></msub><msub><mi>v</mi><mi>𝒟</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mo>log</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1\left( G^{-1}\left[\frac{v_\mathcal{I}}{v_\mathcal{D}}\right] + \log t \right) + \beta_2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><code>scaled-exponential</code></td>
<td>Scaled exponential (beta-delta; <a href="https://doi.org/10.1162/003355397555253" class="external-link">Laibson,
1997</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">w e^{-kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>log</mo><mfrac><msub><mi>v</mi><mi>I</mi></msub><msub><mi>v</mi><mi>D</mi></msub></mfrac><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>t</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1\log\frac{v_{I}}{v_{D}} + \beta_2 t + \beta_3</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">k = \frac{\beta_2}{\beta_1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><msub><mi>β</mi><mn>3</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">w = e^{-\frac{\beta_3}{\beta_1}}</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>nonlinear-time-hyperbolic</code></td>
<td>Nonlinear-time hyperbolic (<a href="https://doi.org/10.1901/jeab.2006.85-05" class="external-link">Rachlin,
2006</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1 + k t^s}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>I</mi></msub><msub><mi>v</mi><mi>D</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>log</mo><mi>t</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1 \sigma^{-1}\left[\frac{v_{I}}{v_{D}}\right] + \beta_2\log t + \beta_3</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>3</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_3}{\beta_1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">s = \frac{\beta_2}{\beta_1}</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>nonlinear-time-exponential</code></td>
<td>Nonlinear-time exponential (<a href="https://doi.org/10.1287/mnsc.1060.0671" class="external-link">Ebert &amp; Prelec,
2007</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></msup><annotation encoding="application/x-tex">e^{-kt^s}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><msup><mi>G</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>ℐ</mi></msub><msub><mi>v</mi><mi>𝒟</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>log</mo><mi>t</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1 G^{-1}\left[\frac{v_\mathcal{I}}{v_\mathcal{D}}\right] + \beta_2\log t + \beta_3</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>3</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_3}{\beta_1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">s = \frac{\beta_2}{\beta_1}</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>⋅</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^{-1}[\cdot]</annotation></semantics></math>
is the logit function, or the quantile function of a standard logistic
distribution, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>⋅</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">G^{-1}[\cdot]</annotation></semantics></math>
is the quantile function of a standard Gumbel distribution (<a href="https://doi.org/10.31234/osf.io/y2fdh" class="external-link">Kinley et al.,
2024</a>)</p>
<p>We can test all of these and select the best according to the
Bayesian Information Criterion as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bclm.html">td_bclm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, model <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting binary choice linear model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: exponential from model exponential.2, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.01003216 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = fml, family = binomial(link = "logit"), data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     .B1      .B2  </span></span>
<span><span class="co">#&gt;   3.597  -16.553  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 70 Total (i.e. Null);  68 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       97.04 </span></span>
<span><span class="co">#&gt; Residual Deviance: 15.7  AIC: 19.7</span></span></code></pre></div>
<p>To explore a wider range of discount functions, we can fit a
nonlinear model by calling <code>td_bcnm</code>. The full list is as
follows:</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Functional form</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson,
1937</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k) = e^{-k t}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Scaled exponential (beta-delta; <a href="https://doi.org/10.1162/003355397555253" class="external-link">Laibson, 1997</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k, w) = w e^{-k t}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Nonlinear-time exponential (<a href="https://doi.org/10.1287/mnsc.1060.0671" class="external-link">Ebert &amp; Prelec,
2007</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k, s) = e^{-k t^s}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Dual-systems exponential (<a href="https://doi.org/10.1002/jeab.6" class="external-link">Ven den Bos &amp; McClure,
2013</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi></mrow></msup><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k_1, k_2, w) = w e^{-k_1 t} + (1 - w) e^{-k_2 t}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Inverse q-exponential (<a href="https://doi.org/10.1037/0033-2909.130.5.769" class="external-link">Green &amp; Myerson,
2004</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">f(t; k, s) = \frac{1}{(1 + k t)^s}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Hyperbolic (<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur,
1987</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(t; k) = \frac{1}{1 + kt}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Nonlinear-time hyperbolic (<a href="https://doi.org/10.1901/jeab.2006.85-05" class="external-link">Rachlin, 2006</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(t; k, s) = \frac{1}{1 + k t^s}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting binary choice model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: exponential, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k      gamma </span></span>
<span><span class="co">#&gt; 0.01086616 0.09327077 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Config:</span></span>
<span><span class="co">#&gt;  noise_dist: logis</span></span>
<span><span class="co">#&gt;  gamma_scale: linear</span></span>
<span><span class="co">#&gt;  transform: identity</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ED50: 63.7895168684722</span></span>
<span><span class="co">#&gt; AUC: 0.025196117630896</span></span>
<span><span class="co">#&gt; BIC: 25.9543389305639</span></span></code></pre></div>
<p>Several additional arguments can be used to customize the model. For
example, we can use different choice rules—the “logistic” choice rule is
the default, but the “probit” and “power” choice rules are also
available (see <a href="https://doi.org/10.1177/0956797616664342" class="external-link">Wulff
and Van den Bos, 2018</a>, for explanations of these):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probit choice rule:</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span>, choice_rule <span class="op">=</span> <span class="st">'probit'</span><span class="op">)</span></span>
<span><span class="co"># Power choice rule:</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span>, choice_rule <span class="op">=</span> <span class="st">'power'</span><span class="op">)</span></span></code></pre></div>
<p>It is also possible to fit an error rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>
that describes the probability of the participant making a response
error (see <a href="https://doi.org/10.3758/s13428-015-0672-2" class="external-link">Vincent,
2015</a>). I.e.:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">imm</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ϵ</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><mi>ϵ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>η</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">P(\text{imm}) = \epsilon + (1 - 2\epsilon) g^{-1}[\eta]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">imm</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\text{imm})</annotation></semantics></math>
is the probability of choosing the immediate reward,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
is the link function, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the linear predictor.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"td_bc_study"</span><span class="op">)</span></span>
<span><span class="co"># Select the second participant</span></span>
<span><span class="va">second_ptpt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">td_bc_study</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">td_bc_study</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">second_ptpt</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">df</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span>, fit_err_rate <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">'endpoints'</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="modeling-binary-choice-data_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can see that the probability of choosing the immediate reward
doesn’t approach 0 or 1.</p>
<p>Alternatively, we might expect that participants should never choose
an immediate reward worth 0 and should never choose a delayed reward
worth the same face amount as an immediate reward <a href="https://doi.org/10.31234/osf.io/y2fdh" class="external-link">(Kinley et al., 2024)</a>.
We can control this by setting <code>fixed_ends = T</code>, which
“fixes” the endpoints of the psychometric curve, where
<code>val_imm = 0</code> and <code>val_imm = val_del</code>, at 0 and 1,
respectively:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">df</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span>, fixed_ends <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">'endpoints'</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="modeling-binary-choice-data_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Kinley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Choice rules • tempodisco</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Choice rules">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tempodisco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tempodisco.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><h6 class="dropdown-header" data-toc-skip>Data preprocessing</h6></li>
    <li><a class="dropdown-item" href="../articles/adjusting-amounts.html">Processing adjusting-amounts data</a></li>
    <li><a class="dropdown-item" href="../articles/nonsystematic-discounting.html">Identifying nonsystematic discounting</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model fitting</h6></li>
    <li><a class="dropdown-item" href="../articles/modeling-binary-choice-data.html">Modeling choice-level data</a></li>
    <li><a class="dropdown-item" href="../articles/visualizing-models.html">Visualizing models</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Statistical inference</h6></li>
    <li><a class="dropdown-item" href="../articles/area-under-curve.html">Measuring area under the curve</a></li>
    <li><a class="dropdown-item" href="../articles/comparing-models.html">Comparing across discount functions</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing-study.html">Analyzing data from multiple participants</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/drift-diffusion-models.html">Drift diffusion models</a></li>
    <li><a class="dropdown-item" href="../articles/custom-discount-functions.html">Custom discount functions</a></li>
    <li><a class="dropdown-item" href="../articles/choice-rules.html">Choice rules</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kinleyid/tempodisco/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Choice rules</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kinleyid/tempodisco/blob/main/vignettes/choice-rules.Rmd" class="external-link"><code>vignettes/choice-rules.Rmd</code></a></small>
      <div class="d-none name"><code>choice-rules.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kinleyid.github.io/tempodisco/">tempodisco</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>When <a href="https://kinleyid.github.io/tempodisco/articles/modeling-binary-choice-data.html">modeling
binary choice data</a> using <a href="https://kinleyid.github.io/tempodisco/reference/td_bcnm.html"><code>td_bcnm</code></a>,
not only the discount function but also the <strong>choice rule</strong>
must be specified. Whereas the discount function is parameterized to
specify how the subjective value of a future reward decreases with
delay, the choice rule is parameterized to specify the probability of
choosing either of two rewards whose subjective values are given. To
illustrate, <code>plot(... type = "summary")</code> visualizes the
discount function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data and fit model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"td_bc_single_ptpt"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">"exponential"</span><span class="op">)</span></span>
<span><span class="co"># Plot the discount curve</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"summary"</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>whereas <code>plot(... type = "endpoints")</code> visualizes the
choice rule (i.e., the psychometric curve for a given combination of
delay and delayed reward value):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the choice rule</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"endpoints"</span>, del <span class="op">=</span> <span class="fl">50</span>, val_del <span class="op">=</span> <span class="fl">200</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Just as we can fit a <a href="https://kinleyid.github.io/tempodisco/articles/comparing-models.html">range
of discount functions</a> to the data, we can also fit several choice
rules using the <code>choice_rule</code> argument to
<code>td_bcnm</code>. Mathematically, each choice rule gives the
probability of selecting the immediate reward,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(I)</annotation></semantics></math>,
given the subjective values of the immediate and delayed rewards
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">SV_I</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">SV_D</annotation></semantics></math>
respectively (where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">SV_I</annotation></semantics></math>
is simply the face value of the immediate reward and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">SV_D</annotation></semantics></math>
depends on the discount curve), and a “sharpness” parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma \geq 0</annotation></semantics></math>,
where a larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
reflects less “noisy” decision making. Built-in choice rules are listed
below.</p>
</div>
<div class="section level2">
<h2 id="built-in-choice-rules">Built-in choice rules<a class="anchor" aria-label="anchor" href="#built-in-choice-rules"></a>
</h2>
<div class="section level3">
<h3 id="logistic">Logistic<a class="anchor" aria-label="anchor" href="#logistic"></a>
</h3>
<p><code>choice_rule = "logistic"</code> (the default) gives the
logistic choice rule:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>σ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub><mo>−</mo><mi>S</mi><msub><mi>V</mi><mi>D</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
P(I) = \sigma\left[\gamma \left( SV_I - SV_D \right) \right]
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is the logistic function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>x</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mo>exp</mo><mo stretchy="false" form="prefix">{</mo><mo>−</mo><mi>x</mi><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\sigma[x] = (1 + \exp\{-x\})^{-1}</annotation></semantics></math>,
which is the cumulative distribution function (CDF) of a logistic
distribution with location parameter 0 and scale parameter 1.</p>
</div>
<div class="section level3">
<h3 id="probit-normal">Probit (normal)<a class="anchor" aria-label="anchor" href="#probit-normal"></a>
</h3>
<p><code>choice_rule = "probit"</code> gives the probit choice rule:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub><mo>−</mo><mi>S</mi><msub><mi>V</mi><mi>D</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
P(I) = \Phi\left[\gamma \left( SV_I - SV_D \right) \right]
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
is the CDF of the standard normal distribution.</p>
</div>
<div class="section level3">
<h3 id="power-log-logistic">Power (log-logistic)<a class="anchor" aria-label="anchor" href="#power-log-logistic"></a>
</h3>
<p><code>choice_rule = "power"</code> gives the power choice rule (<a href="https://doi.org/10.1037/14396-000" class="external-link">Luce, 1959/2005</a>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>S</mi><msubsup><mi>V</mi><mi>I</mi><mi>γ</mi></msubsup></mrow><mrow><mi>S</mi><msubsup><mi>V</mi><mi>I</mi><mi>γ</mi></msubsup><mo>+</mo><mi>S</mi><msubsup><mi>V</mi><mi>D</mi><mi>γ</mi></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
P(I) = \frac{SV_I^\gamma}{SV_I^\gamma + SV_D^\gamma}
</annotation></semantics></math></p>
<p>where the right hand side of the equation is the CDF of a
log-logistic distribution with scale parameter 1 and shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-choice-rules">Comparing choice rules<a class="anchor" aria-label="anchor" href="#comparing-choice-rules"></a>
</h2>
<p>Broadly speaking, the logistic and probit choice rules are
similar—both are based on a “Fechner model” (<a href="https://doi.org/10.1002/bs.3830080106" class="external-link">Becker, DeGroot, &amp;
Marschak, 1963</a>) in which comparisons between subjective reward
values are “noisy”:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub><mo>−</mo><mi>S</mi><msub><mi>V</mi><mi>D</mi></msub><mo>&lt;</mo><mi>ε</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
P(I) = \Pr(SV_I - SV_D &lt; \varepsilon )
</annotation></semantics></math></p>
<p>where the noise, represented by the random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ε</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>,
is assumed to follow either a logistic distribution for the logistic
choice rule, or a normal distribution for the probit choice rule. In
contrast, the power choice rule could be taken to imply the following
Fechner-like model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub></mrow><mrow><mi>S</mi><msub><mi>V</mi><mi>D</mi></msub></mrow></mfrac><mo>&lt;</mo><mi>ε</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
P(I) = \Pr\left( \frac{SV_I}{SV_D} &lt; \varepsilon \right)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ε</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>
is now assumed to follow a log-logistic distribution. Mathematical
details can be found in <a href="https://doi.org/10.1016/j.jmp.2025.102902" class="external-link">Kinley, Oluwasola &amp;
Becker (2025)</a>.</p>
<p>These theoretical differences between the choice rules have the
following practical implications:</p>
<ol style="list-style-type: decimal">
<li>In the logistic and probit choice rules, decisions are less
stochastic (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
is effectively higher) for larger reward magnitudes, whereas decision
stochasticity is constant (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
is effectively constant) for the power choice rule. There is evidence
that real human decision making is indeed less stochastic for larger
reward values (<a href="https://doi.org/10.1038/s41467-020-16852-y" class="external-link">Gershman &amp; Bhui,
2020</a>). However, it is not obvious that trying to capture this effect
for data with a narrow range of reward magnitudes will improve model
fit.</li>
<li>For the logistic and probit choice rules,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(I)</annotation></semantics></math>
is never exactly 0 or 1. In contrast, for the power choice rule,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P(I) = 0</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>V</mi><mi>I</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">SV_I = 0</annotation></semantics></math>.
Thus, for the power choice rule, model fit will be strongly negatively
impacted if a participant ever chose an immediate reward of 0. However,
such decisions are arguably better used for attention checks than model
fitting (see, for example, <a href="https://doi.org/10.1037/pha0000645" class="external-link">Almog et al., 2023</a>).</li>
</ol>
<p>To see the differences between the power choice rule on the one hand
and the logistic and probit choice rules on the other, we can visualize
their predictions for the same participant:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vis_del</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">$</span><span class="va">del</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>del <span class="op">=</span> <span class="va">vis_del</span>, val_del <span class="op">=</span> <span class="fl">200</span>, val_imm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imm_chosen</span> <span class="op">~</span> <span class="va">val_imm</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, <span class="va">del</span> <span class="op">==</span> <span class="va">vis_del</span><span class="op">)</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plot_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span> <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                 <span class="st">"blue"</span> <span class="op">=</span> <span class="st">"probit"</span>,</span>
<span>                 <span class="st">"forestgreen"</span> <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span><span class="va">logLiks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">entry</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plot_legend</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">choice_rule</span> <span class="op">&lt;-</span> <span class="va">plot_legend</span><span class="op">[</span><span class="va">entry</span><span class="op">]</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                 discount_function <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                 choice_rule <span class="op">=</span> <span class="va">choice_rule</span><span class="op">)</span></span>
<span>  <span class="va">logLiks</span><span class="op">[</span><span class="va">entry</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span>  <span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">'response'</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds</span> <span class="op">~</span> <span class="va">newdata</span><span class="op">$</span><span class="va">val_imm</span>, col <span class="op">=</span> <span class="va">entry</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plot_legend</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">plot_legend</span>, <span class="st">'; log lik. = '</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">logLiks</span>, <span class="fl">1</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>As suggested by the log likelihood measurements shown in the legend
above, the choice rule can significantly impact model fit (<a href="https://doi.org/10.1177/0956797616664342" class="external-link">Wulff &amp; van den Bos,
2017</a>). Therefore it is a good idea to explore multiple choice rules
for a given dataset to see which one best describes the data.</p>
</div>
<div class="section level2">
<h2 id="fixed-endpoint-choice-rules">Fixed-endpoint choice rules<a class="anchor" aria-label="anchor" href="#fixed-endpoint-choice-rules"></a>
</h2>
<p>As described earlier, for the power choice rule, the probability of
choosing an immediate reward of $0 is 0. In that sense, the left
endpoint of the psychometric curve is “fixed” at 0. This is arguably an
advantage, if choosing an immediate reward of $0 should be taken as a
failed attention check rather than a reflection of an individual’s true
preferences (<a href="https://doi.org/10.1016/j.jmp.2025.102902" class="external-link">Kinley,
Oluwasola &amp; Becker, 2025</a>). Following this logic, we can create
choice rules in which both endpoints are fixed, i.e., where the
probability of choosing $0 is 0 and where the probability of choosing
$<em>x</em> now over $<em>x</em> at some delay is 1, for all
<em>x</em>.</p>
<p>This option is available through the <code>fixed_ends</code> argument
to <code>td_bcnm</code>. To see its effect, we can re-fit the models
from the plot above with <code>fixed_ends = TRUE</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vis_del</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">$</span><span class="va">del</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">vis_val_del</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>del <span class="op">=</span> <span class="va">vis_del</span>,</span>
<span>                      val_del <span class="op">=</span> <span class="va">vis_val_del</span>,</span>
<span>                      val_imm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">vis_val_del</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imm_chosen</span> <span class="op">~</span> <span class="va">val_imm</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, <span class="va">del</span> <span class="op">==</span> <span class="va">vis_del</span><span class="op">)</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">vis_val_del</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plot_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span> <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                 <span class="st">"blue"</span> <span class="op">=</span> <span class="st">"probit"</span>,</span>
<span>                 <span class="st">"forestgreen"</span> <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span><span class="va">logLiks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">entry</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plot_legend</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">choice_rule</span> <span class="op">&lt;-</span> <span class="va">plot_legend</span><span class="op">[</span><span class="va">entry</span><span class="op">]</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                 discount_function <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                 fixed_ends <span class="op">=</span> <span class="cn">TRUE</span>,                 <span class="co"># Fixed endpoints</span></span>
<span>                 choice_rule <span class="op">=</span> <span class="va">choice_rule</span><span class="op">)</span></span>
<span>  <span class="va">logLiks</span><span class="op">[</span><span class="va">entry</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span>  <span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">'response'</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds</span> <span class="op">~</span> <span class="va">newdata</span><span class="op">$</span><span class="va">val_imm</span>, col <span class="op">=</span> <span class="va">entry</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plot_legend</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">plot_legend</span>, <span class="st">'; log lik. = '</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">logLiks</span>, <span class="fl">1</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Note that the psychometric curves are no longer symmetrical about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">P(I) = 0.5</annotation></semantics></math>
for the logistic and probit choice rules. As before, there is an
important difference between the power choice rule and the others: in
the power choice rule, decisions do not become less stochastic for
larger reward magnitudes. To see this, we can re-plot the psychometric
curves above, but this time predicting what the choice probabilities
would be if the reward magnitudes were multiplied by 5:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vis_del</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">$</span><span class="va">del</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">vis_val_del</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>del <span class="op">=</span> <span class="va">vis_del</span>,</span>
<span>                      val_del <span class="op">=</span> <span class="va">vis_val_del</span>,</span>
<span>                      val_imm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">vis_val_del</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">vis_val_del</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"val_imm"</span>, ylab <span class="op">=</span> <span class="st">"prob_imm"</span><span class="op">)</span></span>
<span><span class="va">plot_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span> <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                 <span class="st">"blue"</span> <span class="op">=</span> <span class="st">"probit"</span>,</span>
<span>                 <span class="st">"forestgreen"</span> <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">entry</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plot_legend</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">choice_rule</span> <span class="op">&lt;-</span> <span class="va">plot_legend</span><span class="op">[</span><span class="va">entry</span><span class="op">]</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                 discount_function <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                 fixed_ends <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 choice_rule <span class="op">=</span> <span class="va">choice_rule</span><span class="op">)</span></span>
<span>  <span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">'response'</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds</span> <span class="op">~</span> <span class="va">newdata</span><span class="op">$</span><span class="va">val_imm</span>, col <span class="op">=</span> <span class="va">entry</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The psychometric curve for the power choice rule looks the same,
while the curves for the logistic and probit choice rules are
substantially steeper.</p>
<p>The mathematical details of how fixed-endpoint choice rules are
generated can be found in <a href="https://doi.org/10.1016/j.jmp.2025.102902" class="external-link">Kinley, Oluwasola &amp;
Becker (2025)</a>. That paper finds that fixed-endpoint choice rules
improve model fit, but there is an important caveat: although the
best-fitting model for a given individual (comparing across discount
functions and choice rules) is often one with a fixed-endpoint choice
rule, this does <strong>not</strong> mean that using a fixed-endpoint
choice rule will improve model fit when a single discount function is
assumed across individuals. In fact, although we have not tested this
systematically, when a given discount function does not provide a good
fit to an individual’s data, using a fixed-endpoint choice rule seems to
often make the model fit <strong>worse</strong>.</p>
<blockquote>
<p>⚠️ In other words, you <strong>should not</strong> run something like
<code>td_bcnm(data = ..., discount_function = "hyperbolic", fixed_ends = TRUE)</code>.
Instead, you should run
<code>td_bcnm(data = ..., fixed_ends = TRUE)</code> to allow a range of
discount functions to be compared.</p>
</blockquote>
<p>For the examples above, we already knew that the data in
<code>td_bc_single_ptpt</code> was well fit by an exponential discount
function, and the model fit turned out to be improved by switching to a
fixed-endpoints choice rule. However, if we repeat the model fitting
using a hyperbolic discount function, which does not fit the data well,
a fixed-endpoint choice rule actually makes the model fit worse:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_free</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                    discount_function <span class="op">=</span> <span class="st">"hyperbolic"</span>,</span>
<span>                    fixed_ends <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mod_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                     discount_function <span class="op">=</span> <span class="st">"hyperbolic"</span>,</span>
<span>                     fixed_ends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'Log lik. with free endpoints: %.2f\n'</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod_free</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log lik. with free endpoints: -13.59</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'Log lik. with fixed endpoints: %.2f\n'</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod_fixed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log lik. with fixed endpoints: -14.02</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="custom-choice-rules">Custom choice rules<a class="anchor" aria-label="anchor" href="#custom-choice-rules"></a>
</h2>
<p>The choice rules described above can be generalized as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>V</mi><mi>I</mi></msub><msub><mi>V</mi><mi>D</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mover><mi>p</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
P(I) = F\left(s(\gamma) \left[ \tau \left( \frac{V_I}{V_D} \right) - \tau\left(\delta\left(t;\vec{p}\right)\right) \right] \right)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\cdot)</annotation></semantics></math>
is the CDF of the distribution of the decision noise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ε</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s(\cdot)</annotation></semantics></math>
is a scale function applied to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau(\cdot)</annotation></semantics></math>
is some transformation. These three functions jointly specify the choice
rule, as described below.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>I</mi></msub><annotation encoding="application/x-tex">V_I</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>D</mi></msub><annotation encoding="application/x-tex">V_D</annotation></semantics></math>
are the face (vs. subjective) values of the immediate and delayed
rewards, respectively, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mover><mi>p</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta(t; \vec{p})</annotation></semantics></math>
is a discount function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
parameterized by some vector of parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>p</mi><mo accent="true">→</mo></mover><annotation encoding="application/x-tex">\vec{p}</annotation></semantics></math>
and evaluated at delay
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p>The functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\cdot)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s(\cdot)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau(\cdot)</annotation></semantics></math>
can be specified using the arguments <code>noise_dist</code>,
<code>gamma_scale</code>, and <code>transform</code>, respectively, to
<code>td_bcnm</code>. When using the argument <code>choice_rule</code>,
these three are pre-set internally as follows (assuming
<code>fixed_ends = FALSE</code>):</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th><code>choice_rule</code></th>
<th><code>noise_dist</code></th>
<th><code>gamma_scale</code></th>
<th><code>transform</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"logistic"</code></td>
<td>
<code>"logis"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\cdot) = \sigma(\cdot)</annotation></semantics></math>
</td>
<td>
<code>"linear"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>γ</mi><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">s(\gamma) = \gamma V_D</annotation></semantics></math>
</td>
<td>
<code>"identity"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\tau(x) = x</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>"probit"</code></td>
<td>
<code>"norm"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\cdot) = \Phi(\cdot)</annotation></semantics></math>
</td>
<td>
<code>"linear"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>γ</mi><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">s(\gamma) = \gamma V_D</annotation></semantics></math>
</td>
<td>
<code>"identity"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\tau(x) = x</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>"power"</code></td>
<td>
<code>"logis"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\cdot) = \sigma(\cdot)</annotation></semantics></math>
</td>
<td>
<code>"none"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>γ</mi></mrow><annotation encoding="application/x-tex">s(\gamma) = \gamma</annotation></semantics></math>
</td>
<td>
<code>"log"</code>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\tau(x) = \log x</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>Note that <code>noise_dist</code> must be a string to which the
prefixes <code>p</code> and <code>q</code> can be prepended to refer to
a probability distribution’s CDF and quantile functions, respectively
(e.g., <code>pnorm</code> is the CDF of the normal distribution,
<code>qlogis</code> is the quantile function of the logistic
distribution). Note also that fixed-endpoint versions of these choice
rules are generated by setting
<code>transform = "noise_dist_quantile"</code>, which results in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau(x) = F^{-1}(x)</annotation></semantics></math>
(for an explanation, see <a href="https://doi.org/10.1016/j.jmp.2025.102902" class="external-link">Kinley, Oluwasola &amp;
Becker, 2025</a>).</p>
<p>When we set <code>noise_dist</code>, <code>gamma_scale</code>, and
<code>transform</code> ourselves, the arguments <code>choice_rule</code>
and <code>fixed_ends</code> are ignored, allowing us to generate custom
choice rules as shown below.</p>
<div class="section level3">
<h3 id="example-1-cauchit-choice-rule">Example 1: Cauchit choice rule<a class="anchor" aria-label="anchor" href="#example-1-cauchit-choice-rule"></a>
</h3>
<p>To create a Cauchit choice rule (analogous to Cauchit regression in
the way the probit choice rule is analogous to probit regression), we
could use the same configuration as for the probit choice rule, but
switch the <code>noise_dist</code> to <code>"cauchy"</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_cauchit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                       discount_function <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                       noise_dist <span class="op">=</span> <span class="st">"cauchy"</span>,</span>
<span>                       gamma_scale <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>                       transform <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_cauchit</span>, type <span class="op">=</span> <span class="st">"endpoints"</span>, del <span class="op">=</span> <span class="fl">50</span>, val_del <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The psychometric curve is now generated by a shifted and scaled
arctan function. We can create a fixed-endpoint variant of this choice
rule by setting <code>transform = "noise_dist_quantile"</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_cauchit_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                             discount_function <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                             noise_dist <span class="op">=</span> <span class="st">"cauchy"</span>,</span>
<span>                             gamma_scale <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>                             transform <span class="op">=</span> <span class="st">"noise_dist_quantile"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_cauchit_fixed</span>, type <span class="op">=</span> <span class="st">"endpoints"</span>, del <span class="op">=</span> <span class="fl">50</span>, val_del <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="example-2-log-normal-choice-rule">Example 2: log-normal choice rule<a class="anchor" aria-label="anchor" href="#example-2-log-normal-choice-rule"></a>
</h3>
<p>In the same way that the power choice rule is based on the
log-logistic distribution, we can create a choice rule based on the
log-normal distribution as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_lognormal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>,</span>
<span>                         discount_function <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                         noise_dist <span class="op">=</span> <span class="st">"norm"</span>,</span>
<span>                         gamma_scale <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                         transform <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_lognormal</span>, type <span class="op">=</span> <span class="st">"endpoints"</span>, del <span class="op">=</span> <span class="fl">50</span>, val_del <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p><img src="choice-rules_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>As with the power choice rule, the left endpoint of the psychometric
curve is fixed, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P(I) = 0</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>I</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">V_I = 0</annotation></semantics></math>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Kinley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Temporal Discounting Models • tempodisco</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Temporal Discounting Models">
<meta name="description" content="Tools for working with temporal discounting data, designed for behavioural researchers to simplify data cleaning/scoring and model fitting. The package implements widely used methods such as computing indifference points from adjusting amount task (Frye et al., 2016, &lt;doi:10.3791/53584&gt;), testing for non-systematic discounting per the criteria of Johnson &amp; Bickel (2008, &lt;doi:10.1037/1064-1297.16.3.264&gt;), scoring questionnaires according to the methods of Kirby et al. (1999, &lt;doi:10.1037//0096-3445.128.1.78&gt;) and Wileyto et al (2004, &lt;doi:10.3758/BF03195548&gt;), Bayesian model selection using a range of discount functions (Franck et al., 2015, &lt;doi:10.1002/jeab.128&gt;), drift diffusion models of discounting (Peters &amp; D'Esposito, 2020, &lt;doi:10.1371/journal.pcbi.1007615&gt;), and model-agnostic measures of discounting such as area under the curve (Myerson et al., 2001, &lt;doi:10.1901/jeab.2001.76-235&gt;) and ED50 (Yoon &amp; Higgins, 2008, &lt;doi:10.1016/j.drugalcdep.2007.12.011&gt;).">
<meta property="og:description" content="Tools for working with temporal discounting data, designed for behavioural researchers to simplify data cleaning/scoring and model fitting. The package implements widely used methods such as computing indifference points from adjusting amount task (Frye et al., 2016, &lt;doi:10.3791/53584&gt;), testing for non-systematic discounting per the criteria of Johnson &amp; Bickel (2008, &lt;doi:10.1037/1064-1297.16.3.264&gt;), scoring questionnaires according to the methods of Kirby et al. (1999, &lt;doi:10.1037//0096-3445.128.1.78&gt;) and Wileyto et al (2004, &lt;doi:10.3758/BF03195548&gt;), Bayesian model selection using a range of discount functions (Franck et al., 2015, &lt;doi:10.1002/jeab.128&gt;), drift diffusion models of discounting (Peters &amp; D'Esposito, 2020, &lt;doi:10.1371/journal.pcbi.1007615&gt;), and model-agnostic measures of discounting such as area under the curve (Myerson et al., 2001, &lt;doi:10.1901/jeab.2001.76-235&gt;) and ED50 (Yoon &amp; Higgins, 2008, &lt;doi:10.1016/j.drugalcdep.2007.12.011&gt;).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tempodisco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/adjusting-amounts.html">Working with data from an adjusting amount procedure</a></li>
    <li><a class="dropdown-item" href="articles/analyzing-study.html">Analyzing data from multiple participants</a></li>
    <li><a class="dropdown-item" href="articles/area-under-curve.html">Computing area under the curve (AUC)</a></li>
    <li><a class="dropdown-item" href="articles/comparing-models.html">Comparing discounting across different discount functions</a></li>
    <li><a class="dropdown-item" href="articles/custom-discount-functions.html">Creating custom discount functions</a></li>
    <li><a class="dropdown-item" href="articles/drift-diffusion-models.html">Drift diffusion models</a></li>
    <li><a class="dropdown-item" href="articles/getting-started.html">Getting started</a></li>
    <li><a class="dropdown-item" href="articles/modeling-binary-choice-data.html">Modeling binary choice data</a></li>
    <li><a class="dropdown-item" href="articles/nonsystematic-discounting.html">Indentifying non-systematic discounting</a></li>
    <li><a class="dropdown-item" href="articles/visualizing-models.html">Visualizing models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kinleyid/tempodisco/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tempodisco">tempodisco<a class="anchor" aria-label="anchor" href="#tempodisco"></a>
</h1></div>
<!-- badges: start -->

<p><code>tempodisco</code> is an R package for behavioural researchers working with delay discounting data (also known as temporal discounting intertemporal choice data). It is intended to simplify common tasks such as scoring responses (e.g. computing indifference points from an adjusting amounts procedure, computing the “area under the curve”, or computing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> values as in the Monetary Choice Questionnaire; <a href="https://doi.org/10.1037//0096-3445.128.1.78" class="external-link">Kirby et al., 1999</a>), identifying poor-quality data (e.g. non-systematic responding and failed attention checks), modelling choice data using multiple discount functions (e.g. hyperbolic, exponential, etc.—see below), and modelling reaction times using drift diffusion models.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install tempodisco from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kinleyid/tempodisco"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-usage">Example usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kinleyid.github.io/tempodisco/">tempodisco</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="modeling-indifference-point-data">Modeling indifference point data<a class="anchor" aria-label="anchor" href="#modeling-indifference-point-data"></a>
</h3>
<p>To compute indifference points from an adjusting amount procedure, we can use the <code>adj_amt_indiffs</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"adj_amt_sim"</span><span class="op">)</span> <span class="co"># Load simulated data from an adjusting amounts procedure</span></span>
<span><span class="va">indiff_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/adj_amt_indiffs.html">adj_amt_indiffs</a></span><span class="op">(</span><span class="va">adj_amt_sim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indiff_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   del   indiff</span></span>
<span><span class="co">#&gt; 1   7 0.984375</span></span>
<span><span class="co">#&gt; 2  30 0.859375</span></span>
<span><span class="co">#&gt; 3  90 0.046875</span></span>
<span><span class="co">#&gt; 4 180 0.453125</span></span>
<span><span class="co">#&gt; 5 360 0.015625</span></span></code></pre></div>
<p>This returns a data frame containing the delays and corresponding indifference points. The function <code>td_ipm</code> can then be used to identify the best-fitting discount function (according to the Bayesian information criterion) from any subset of the following options:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Functional form</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson, 1937</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k) = e^{-k t}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Scaled exponential (beta-delta; <a href="https://doi.org/10.1162/003355397555253" class="external-link">Laibson, 1997</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k, w) = w e^{-k t}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Nonlinear-time exponential (<a href="https://doi.org/10.1287/mnsc.1060.0671" class="external-link">Ebert &amp; Prelec, 2007</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k, s) = e^{-k t^s}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Dual-systems exponential (<a href="https://doi.org/10.1002/jeab.6" class="external-link">Ven den Bos &amp; McClure, 2013</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi></mrow></msup><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k_1, k_2, w) = w e^{-k_1 t} + (1 - w) e^{-k_2 t}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Inverse q-exponential (<a href="https://doi.org/10.1037/0033-2909.130.5.769" class="external-link">Green &amp; Myerson, 2004</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">f(t; k, s) = \frac{1}{(1 + k t)^s}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Hyperbolic (<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur, 1987</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(t; k) = \frac{1}{1 + kt}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Nonlinear-time hyperbolic (<a href="https://doi.org/10.1901/jeab.2006.85-05" class="external-link">Rachlin, 2006</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(t; k, s) = \frac{1}{1 + k t^s}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/td_ipm.html">td_ipm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indiff_data</span>, discount_function <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'exponential'</span>, <span class="st">'hyperbolic'</span>, <span class="st">'nonlinear-time-hyperbolic'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting indifference point model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: hyperbolic, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.01767284 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ED50: 56.5840102782019</span></span>
<span><span class="co">#&gt; AUC: 0.313783753467372</span></span></code></pre></div>
<p>From here, we can extract useful information about the model and visualize it</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span> <span class="co"># k value</span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.01767284</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span> <span class="co"># Bayesian information criterion</span></span>
<span><span class="co">#&gt; [1] 1.937008</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modeling-binary-choice-data">Modeling binary choice data<a class="anchor" aria-label="anchor" href="#modeling-binary-choice-data"></a>
</h3>
<p>A traditional method of modeling binary choice data is to compute a value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> using the scoring method introduced for the Kirby Monetary Choice Questionnaire:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"td_bc_single_ptpt"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/kirby_score.html">kirby_score</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.02176563</span></span></code></pre></div>
<p>(<a href="https://doi.org/10.1037/0096-3445.128.1.78" class="external-link">Kirby, 1999</a>)</p>
<p>Another option is to use the logistic regression method of Wileyto et al., where we can solve for the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> value of the hyperbolic discount function in terms of the regression coefficients:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/wileyto_score.html">wileyto_score</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting binary choice linear model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: hyperbolic from model hyperbolic.1, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.04372626 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = fml, family = binomial(link = "logit"), data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     .B1      .B2  </span></span>
<span><span class="co">#&gt; 0.49900  0.02182  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 70 Total (i.e. Null);  68 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       97.04 </span></span>
<span><span class="co">#&gt; Residual Deviance: 37.47     AIC: 41.47</span></span></code></pre></div>
<p>(<a href="https://doi.org/10.3758/BF03195548" class="external-link">Wileyto et al., 2004</a>)</p>
<p>We can extend this approach to a number of other discount functions using the <code>method</code> argument to <code>td_bclm</code>:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Discount function</th>
<th>Linear predictor</th>
<th>Parameters</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>hyperbolic.1</code></td>
<td>Hyperbolic (<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur, 1987</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1 + kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>v</mi><mi>D</mi></msub><msub><mi>v</mi><mi>I</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>t</mi></mrow><annotation encoding="application/x-tex">\beta_1 \left(1 - \frac{v_D}{v_I} \right) + \beta_2 t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">k = \frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><code>hyperbolic.2</code></td>
<td>(<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur, 1987</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1 + kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>ℐ</mi></msub><msub><mi>v</mi><mi>𝒟</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mo>log</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1\left( \sigma^{-1}\left[\frac{v_\mathcal{I}}{v_\mathcal{D}}\right] + \log t \right) + \beta_2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><code>exponential.1</code></td>
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson, 1937</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup><annotation encoding="application/x-tex">e^{-kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>log</mo><mfrac><msub><mi>v</mi><mi>I</mi></msub><msub><mi>v</mi><mi>D</mi></msub></mfrac><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>t</mi></mrow><annotation encoding="application/x-tex">\beta_1 \log \frac{v_I}{v_D} + \beta_2 t</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">k = \frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><code>exponential.2</code></td>
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson, 1937</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup><annotation encoding="application/x-tex">e^{-kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>G</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>ℐ</mi></msub><msub><mi>v</mi><mi>𝒟</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mo>log</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1\left( G^{-1}\left[\frac{v_\mathcal{I}}{v_\mathcal{D}}\right] + \log t \right) + \beta_2</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_2}{\beta_1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><code>scaled-exponential</code></td>
<td>Scaled exponential (beta-delta; <a href="https://doi.org/10.1162/003355397555253" class="external-link">Laibson, 1997</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">w e^{-kt}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>log</mo><mfrac><msub><mi>v</mi><mi>I</mi></msub><msub><mi>v</mi><mi>D</mi></msub></mfrac><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>t</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1\log\frac{v_{I}}{v_{D}} + \beta_2 t + \beta_3</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">k = \frac{\beta_2}{\beta_1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><msub><mi>β</mi><mn>3</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">w = e^{-\frac{\beta_3}{\beta_1}}</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>nonlinear-time-hyperbolic</code></td>
<td>Nonlinear-time hyperbolic (<a href="https://doi.org/10.1901/jeab.2006.85-05" class="external-link">Rachlin, 2006</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1 + k t^s}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>I</mi></msub><msub><mi>v</mi><mi>D</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>log</mo><mi>t</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1 \sigma^{-1}\left[\frac{v_{I}}{v_{D}}\right] + \beta_2\log t + \beta_3</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>3</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_3}{\beta_1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">s = \frac{\beta_2}{\beta_1}</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>nonlinear-time-exponential</code></td>
<td>Nonlinear-time exponential (<a href="https://doi.org/10.1287/mnsc.1060.0671" class="external-link">Ebert &amp; Prelec, 2007</a>):<br><br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></msup><annotation encoding="application/x-tex">e^{-kt^s}</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><msup><mi>G</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><msub><mi>v</mi><mi>ℐ</mi></msub><msub><mi>v</mi><mi>𝒟</mi></msub></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>log</mo><mi>t</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1 G^{-1}\left[\frac{v_\mathcal{I}}{v_\mathcal{D}}\right] + \beta_2\log t + \beta_3</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>e</mi><mfrac><msub><mi>β</mi><mn>3</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></msup></mrow><annotation encoding="application/x-tex">k = e^\frac{\beta_3}{\beta_1}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mfrac><msub><mi>β</mi><mn>2</mn></msub><msub><mi>β</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">s = \frac{\beta_2}{\beta_1}</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>Where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>⋅</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^{-1}[\cdot]</annotation></semantics></math> is the logit function, or the quantile function of a standard logistic distribution, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>⋅</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">G^{-1}[\cdot]</annotation></semantics></math> is the quantile function of a standard Gumbel distribution (<a href="https://doi.org/10.31234/osf.io/y2fdh" class="external-link">Kinley et al., 2024</a>)</p>
<p>By setting <code>method = "all"</code> (the default), <code>td_bclm</code> tests all of the above models and returns the best-fitting one, according to the Bayesian information criterion:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/td_bclm.html">td_bclm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, model <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting binary choice linear model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: exponential from model exponential.2, with coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          k </span></span>
<span><span class="co">#&gt; 0.01003216 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = fml, family = binomial(link = "logit"), data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     .B1      .B2  </span></span>
<span><span class="co">#&gt;   3.597  -16.553  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 70 Total (i.e. Null);  68 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       97.04 </span></span>
<span><span class="co">#&gt; Residual Deviance: 15.7  AIC: 19.7</span></span></code></pre></div>
<p>We can explore an even wider range of discount functions using nonlinear modeling with <code>td_bcnm</code>. When <code>discount_function = "all"</code> (the default), all of the following models are tested and the best-fitting one (according to the Bayesian information criterion) is returned:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Functional form</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exponential (<a href="https://doi.org/10.2307/2967612" class="external-link">Samuelson, 1937</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k) = e^{-k t}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Scaled exponential (beta-delta; <a href="https://doi.org/10.1162/003355397555253" class="external-link">Laibson, 1997</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k, w) = w e^{-k t}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Nonlinear-time exponential (<a href="https://doi.org/10.1287/mnsc.1060.0671" class="external-link">Ebert &amp; Prelec, 2007</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k, s) = e^{-k t^s}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Dual-systems exponential (<a href="https://doi.org/10.1002/jeab.6" class="external-link">Ven den Bos &amp; McClure, 2013</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>w</mi><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi></mrow></msup><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(t; k_1, k_2, w) = w e^{-k_1 t} + (1 - w) e^{-k_2 t}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Inverse q-exponential (<a href="https://doi.org/10.1037/0033-2909.130.5.769" class="external-link">Green &amp; Myerson, 2004</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">f(t; k, s) = \frac{1}{(1 + k t)^s}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Hyperbolic (<a href="https://doi.org/10.4324/9781315825502" class="external-link">Mazur, 1987</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(t; k) = \frac{1}{1 + kt}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Nonlinear-time hyperbolic (<a href="https://doi.org/10.1901/jeab.2006.85-05" class="external-link">Rachlin, 2006</a>)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>k</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><msup><mi>t</mi><mi>s</mi></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(t; k, s) = \frac{1}{1 + k t^s}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, log <span class="op">=</span> <span class="st">'x'</span>, verbose <span class="op">=</span> <span class="cn">F</span>, p_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="drift-diffusion-models">Drift diffusion models<a class="anchor" aria-label="anchor" href="#drift-diffusion-models"></a>
</h3>
<p>To model reaction times using a drift diffusion model, we can use <code>td_ddm</code> (here, for speed, we are starting the optimization near optimal values for this dataset):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ddm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/td_ddm.html">td_ddm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span>,</span>
<span>              v_par_starts <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>              beta_par_starts <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>              alpha_par_starts <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>              tau_par_starts <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ddm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Temporal discounting drift diffusion model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discount function: exponential</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           k           v        beta       alpha         tau </span></span>
<span><span class="co">#&gt; 0.009664986 0.008541880 0.591146000 3.501014882 0.903601241 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "none" transform applied to drift rates.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ED50: 71.7173522454106</span></span>
<span><span class="co">#&gt; AUC: 0.0283275204463082</span></span>
<span><span class="co">#&gt; BIC: 260.86822208669</span></span></code></pre></div>
<p>Following <a href="https://doi.org/10.1371/journal.pcbi.1007615" class="external-link">Peters &amp; D’Esposito (2020)</a>, we can apply a sigmoidal transform to the drift rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math> to improve model fit using the argument <code>drift_transform = "sigmoid"</code>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mi>′</mi><mo>=</mo><msub><mi>v</mi><mtext mathvariant="normal">max</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>2</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>δ</mi></mrow></msup></mrow></mfrac><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta' = v_\text{max} \left(\frac{2}{1 + e^{-\delta}} - 1\right)</annotation></semantics></math></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ddm_sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/td_ddm.html">td_ddm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'exponential'</span>,</span>
<span>              drift_transform <span class="op">=</span> <span class="st">'sigmoid'</span>,</span>
<span>              v_par_starts <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>              beta_par_starts <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>              alpha_par_starts <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>              tau_par_starts <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ddm_sig</span><span class="op">)</span></span>
<span><span class="co">#&gt;             k             v          beta         alpha           tau </span></span>
<span><span class="co">#&gt;    0.01059955    0.03568827    0.58234627    3.85938224    0.83088464 </span></span>
<span><span class="co">#&gt; max_abs_drift </span></span>
<span><span class="co">#&gt;    1.14207920</span></span></code></pre></div>
<p>This introduces a new variable <code>max_abs_drift</code> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mtext mathvariant="normal">max</mtext></msub><annotation encoding="application/x-tex">v_\text{max}</annotation></semantics></math> in the equation above) controlling the absolute value of the maximum drift rate.</p>
<p>We can use the model to predict reaction times and compare them to the actual data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_rts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ddm_sig</span>, type <span class="op">=</span> <span class="st">'rt'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">pred_rts</span>, <span class="va">td_bc_single_ptpt</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  pred_rts and td_bc_single_ptpt$rt</span></span>
<span><span class="co">#&gt; t = 3.2509, df = 68, p-value = 0.001791</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.1442124 0.5539902</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;       cor </span></span>
<span><span class="co">#&gt; 0.3667584</span></span></code></pre></div>
<p>We can also plot reaction times against the model’s predictions:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ddm_sig</span>, type <span class="op">=</span> <span class="st">'rt'</span>, confint <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="the-model-free-discount-function">The “model-free” discount function<a class="anchor" aria-label="anchor" href="#the-model-free-discount-function"></a>
</h3>
<p>In addition to the discount functions listed above, we can fit a “model-free” discount function to the data, meaning we fit each indifference point independently. This enables us to, first, test whether a participant exhibits non-systematic discounting according to the Johnson &amp; Bickel criteria:</p>
<ul>
<li>C1 (monotonicity): No indifference point can exceed the previous by more than 0.2 (i.e., 20% of the larger delayed reward)</li>
<li>C2 (minimal discounting): The last indifference point must be lower than first by at least 0.1 (i.e., 10% of the larger delayed reward)</li>
</ul>
<p>(<a href="https://doi.org/10.1037/1064-1297.16.3.264" class="external-link">Johnson &amp; Bickel, 2008</a>)</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/td_bcnm.html">td_bcnm</a></span><span class="op">(</span><span class="va">td_bc_single_ptpt</span>, discount_function <span class="op">=</span> <span class="st">'model-free'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="reference/nonsys.html">nonsys</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span> <span class="co"># Model violates neither criterion; no non-systematic discounting detected</span></span>
<span><span class="co">#&gt;    C1    C2 </span></span>
<span><span class="co">#&gt; FALSE FALSE</span></span></code></pre></div>
<p>We can also measure the model-free area under the curve (AUC), a useful model-agnostic measure of discounting.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="reference/AUC.html">AUC</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Defaulting to max_del = 3652.5</span></span>
<span><span class="co">#&gt; Assuming an indifference point of 1 at delay 0</span></span>
<span><span class="co">#&gt; Defaulting to val_del = 198.314285714286</span></span>
<span><span class="co">#&gt; [1] 0.03146756</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reporting-issues-and-requesting-features">Reporting issues and requesting features<a class="anchor" aria-label="anchor" href="#reporting-issues-and-requesting-features"></a>
</h2>
<p>If you encounter problems with the software or would like to it to have additional functionality, please open a new issue on the GitHub repository. Try to include as much detail as possible, especially how to reproduce any errors/incorrect results. GitHub has instructions on opening an issue <a href="https://docs.github.com/en/issues/tracking-your-work-with-issues/using-issues/creating-an-issue" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>If you would like to contribute to <code>tempodisco</code>, you’re more than welcome! Please follow the instructions <a href="https://docs.github.com/en/get-started/exploring-projects-on-github/contributing-to-a-project" class="external-link">here</a> on how to contribute to a project on GitHub. Feel free to <a href="https://kinleyid.github.io" class="external-link">contact me</a> if you’d like help with any contributions.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kinleyid/tempodisco/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kinleyid/tempodisco/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tempodisco</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Isaac Kinley <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kinleyid/tempodisco/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/kinleyid/tempodisco/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/github/kinleyid/tempodisco" class="external-link"><img src="https://codecov.io/github/kinleyid/tempodisco/graph/badge.svg?token=CCQXS3SNGB" alt="codecov"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Kinley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
